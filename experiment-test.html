<!DOCTYPE html>
<html>

<head>
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="manifest" href="favicon/site.webmanifest">
  <link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#5bbad5">

  <script src="js/jsPsych/jspsych.js"></script>
  <script src="js/jsPsych/plugins/jspsych-html-keyboard-response.js"></script>
  <script src="js/jsPsych/plugins/jspsych-html-button-response.js"></script>
  <script src="js/jsPsych/plugins/jspsych-webgazer-init-camera.js"></script>
  <script src="js/jsPsych/plugins/jspsych-webgazer-calibrate.js"></script>
  <script src="js/jsPsych/plugins/jspsych-webgazer-validate.js"></script>
  <script src="js/webgazer.js"></script>
  <script src="js/precision_calculation.js"></script>
  <script src="js/jsPsych/extensions/jspsych-ext-webgazer.js"></script>
  <link href="css/experiment.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="js/jsPsych/css/jspsych.css">
  

  <style>
    .jspsych-content { max-width: 100%;}
  </style>
</head>

<body></body>

<script>

  var camera_instructions = {
    type: 'html-button-response',
    stimulus: `
      <p style="font-size:1.87em;">This experiment uses your camera for eye tracking.</p><br /><br />
      <p style="font-size:1.17em; line-height:2em;">In order to participate you must allow the experiment to use your camera.</p>
      <p style="font-size:1.17em;line-height:2em;">You will be prompted to do this on the next screen.</p>
      <p style="font-size:1.17em;line-height:2em;">If you do not want to permit the experiment to use your camera, please close the page.</p>
    `,
    choices: ['CLICK TO BEGIN'],
    button_html:'<button class="buttonish">%choice%</button>',
    post_trial_gap: 1000
  }

  var init_camera = {
    type: 'webgazer-init-camera',
    css_classes:['wegazer-init-container', 'h', 'buttonish']
    
  }

  var calibration_instructions = {
    type: 'html-button-response',
    stimulus: `
      <p style="font-size:1.87em;>Great! Now the eye tracker will be calibrated to translate<br/> the image of your eyes from the webcam to a location on your screen.</p><br /><br />
      <p style="font-size:1.07em;line-height:2em;"">To do this, you need to click a series of dots.</p>
      <p style="font-size:1.07em;line-height:2em;"">Keep your head still, and click on each dot as it appears. Look at the dot as you click it.</p>
    `,
    choices: ['Click to begin'],
    button_html:'<button class="buttonish">%choice%</button>',
    post_trial_gap: 1000
  }

  var calibration = {
    type: 'webgazer-calibrate',
    calibration_points: [[50,50], [25,25], [25,75], [75,25], [75,75]],
    repetitions_per_point: 3,
    randomize_calibration_order: true,
  }

  var validation_instructions = {
    type: 'html-button-response',
    stimulus: `
      <p style="font-size:1.87em;">Let's see how accurate the eye tracking is. </p><br /><br/>
      <p style="font-size:1.07em;line-height:2em;">Keep your head still, and move your eyes to focus on each dot as it appears.</p>
      <p style="font-size:1.07em;line-height:2em;">You do not need to click on the dots. Just move your eyes to look at the dots.</p>
    `,
    choices: ['CLICK TO BEGIN'],
    button_html:'<button class="buttonish">%choice%</button>',
    post_trial_gap: 1000
  }

  var validation = {
    type: 'webgazer-validate',
    validation_points: [[25,25], [25,75], [75,25], [75,75]],
    validation_points_coordinates:'percent',
    show_validation_data: true,
    randomize_calibration_order: false
  }

  var task_instructions = {
    type: "html-button-response",
    stimulus: `
      <p style="font-size:1.87em;">In this experiment you'll see appearing two different types of content: <br />
        on the right, a <strong>violent</strong> one and on the left an <strong>erotic</strong> content.</p>
      <p style="font-size:1.07em;line-height:2em;">These content will appear randomly selected from a group of 35 videos for each category</p>
      <div class='container' style='width: 100%;'>
        <div class='vidSection' style='display:flex;flex-direction:row;justify-content:space-between;'>
          <video controls autoplay src='vid/sex.mp4' style='justify-self:flex-start;'></video>
          <video controls autoplay src='vid/violence.mp4' style='justify-self:flex-end;'></video>
        </div>
        <p style="font-size:1.07em;line-height:2em;">Click on the button to access the experiment</p>
      </div>
    `,
    choices: ['GO TO THE EXPERIMENT'],
    button_html:'<button class="buttonish">%choice%</button>',
    post_trial_gap: 1000
  }
  var timeline = [];
  
  timeline.push(camera_instructions);
  timeline.push(init_camera);
  timeline.push(calibration_instructions);
  timeline.push(calibration);
  timeline.push(validation_instructions);
  timeline.push(validation);
  timeline.push(task_instructions);
  


  jsPsych.init({
    timeline: timeline,
    preload_video:[
    'vid/sex.mp4',
    'vid/sex_2.mp4',
    'vid/sex_3.mp4',
    'vid/sex_4.mp4',
   'vid/violence.mp4',
    'vid/violence_2.mp4' ,
    'vid/violence_3.mp4',
    'vid/violence_4.mp4'

    ],
    extensions: [
      {type: 'webgazer'}
    ]
  })
</script>

</html>